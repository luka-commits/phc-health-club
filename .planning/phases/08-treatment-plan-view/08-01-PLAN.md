---
phase: 08-treatment-plan-view
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/types/treatment-plan.ts
  - src/components/treatment-plan/medication-item.tsx
  - src/components/treatment-plan/prescriptions-section.tsx
  - src/components/treatment-plan/peptides-section.tsx
  - src/components/treatment-plan/supplements-section.tsx
  - src/components/treatment-plan/lifestyle-section.tsx
  - src/components/treatment-plan/nutrition-section.tsx
  - src/components/treatment-plan/training-section.tsx
autonomous: true
---

<objective>
Create TypeScript types and display components for treatment plan sections.

Purpose: Replace JSON.stringify output with properly formatted, patient-friendly display components that clearly communicate treatment protocols.
Output: Type definitions and 7 reusable display components for all treatment plan tabs.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-treatment-plan-view/08-CONTEXT.md

@src/types/database.ts
@src/app/(dashboard)/patient/treatment-plan/page.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TypeScript types for treatment plan section data</name>
  <files>src/types/treatment-plan.ts</files>
  <action>
Create structured TypeScript interfaces for treatment plan JSONB fields:

1. **Prescription item type:**
   - name: string (medication name)
   - dosage: string (e.g., "200mg")
   - frequency: string (e.g., "twice weekly")
   - timing: 'morning' | 'evening' | 'with_food' | 'before_bed' | 'as_directed'
   - instructions?: string (additional notes)
   - startDate?: string

2. **Peptide item type:**
   - name: string (peptide name)
   - dosage: string (e.g., "250mcg")
   - frequency: string (e.g., "5 days on, 2 days off")
   - timing: 'morning' | 'evening' | 'before_bed' | 'as_directed'
   - injectionSite?: string
   - instructions?: string

3. **Supplement item type:**
   - name: string
   - dosage: string (e.g., "1000mg")
   - frequency: string (e.g., "daily")
   - timing: 'morning' | 'evening' | 'with_food' | 'before_bed' | 'as_directed'
   - brand?: string
   - instructions?: string

4. **Lifestyle section type:**
   - sleep?: { recommendation: string; notes?: string }
   - stress?: { recommendation: string; notes?: string }
   - habits?: { recommendation: string; notes?: string }[]
   - generalNotes?: string

5. **Nutrition section type:**
   - calories?: number
   - protein?: number (grams)
   - carbs?: number (grams)
   - fat?: number (grams)
   - guidelines?: string[]
   - restrictions?: string[]
   - generalNotes?: string

6. **Training section type:**
   - frequency?: string (e.g., "4x per week")
   - focus?: string[] (e.g., ["strength", "cardio"])
   - exercises?: { name: string; sets?: number; reps?: string; notes?: string }[]
   - generalNotes?: string

Export all types. These will be used by display components and eventually by the provider editor in Phase 15.
  </action>
  <verify>npx tsc --noEmit passes</verify>
  <done>All treatment plan section types exported from src/types/treatment-plan.ts</done>
</task>

<task type="auto">
  <name>Task 2: Create display components for medication sections</name>
  <files>src/components/treatment-plan/medication-item.tsx, src/components/treatment-plan/prescriptions-section.tsx, src/components/treatment-plan/peptides-section.tsx, src/components/treatment-plan/supplements-section.tsx</files>
  <action>
Create display components for Prescriptions, Peptides, and Supplements tabs:

1. **MedicationItem component** (reusable card for any medication-like item):
   - Props: name, dosage, frequency, timing, instructions (optional)
   - Display: Card with medication name as title, dosage badge, frequency text, timing indicator (use appropriate icon: Sun for morning, Moon for evening, Utensils for with_food, etc.)
   - Use shadcn Card, Badge components
   - Clean, scannable layout

2. **PrescriptionsSection component**:
   - Props: data (prescriptions_data from treatment plan, typed as Prescription[] | null)
   - If null/empty: show EmptyState with Pill icon
   - If data: map through items, render MedicationItem for each
   - Grid layout (1 col mobile, 2 cols desktop)

3. **PeptidesSection component**:
   - Props: data (peptides_data, typed as Peptide[] | null)
   - If null/empty: show EmptyState with FlaskConical icon
   - If data: map through items, render MedicationItem for each
   - Include injection site info if available

4. **SupplementsSection component**:
   - Props: data (supplements_data, typed as Supplement[] | null)
   - If null/empty: show EmptyState with Leaf icon
   - If data: map through items, render MedicationItem for each
   - Include brand if available

All components: Use 'use client' directive. Import types from treatment-plan.ts. Handle null/undefined gracefully.
  </action>
  <verify>npx tsc --noEmit passes, no import errors</verify>
  <done>All 4 medication display components created and type-safe</done>
</task>

<task type="auto">
  <name>Task 3: Create display components for lifestyle sections</name>
  <files>src/components/treatment-plan/lifestyle-section.tsx, src/components/treatment-plan/nutrition-section.tsx, src/components/treatment-plan/training-section.tsx</files>
  <action>
Create display components for Lifestyle, Nutrition, and Training tabs:

1. **LifestyleSection component**:
   - Props: data (lifestyle_behaviors, typed as LifestyleData | null)
   - If null/empty: show EmptyState with Dumbbell icon
   - Display sections for Sleep, Stress, Habits with recommendations
   - Use Card layout with clear section headings
   - Show generalNotes at bottom if present

2. **NutritionSection component**:
   - Props: data (nutrition, typed as NutritionData | null)
   - If null/empty: show EmptyState with Apple icon
   - Show macro targets if present (calories, protein, carbs, fat) in a grid
   - List guidelines as bullet points
   - List restrictions with warning styling
   - Show generalNotes at bottom if present

3. **TrainingSection component**:
   - Props: data (training, typed as TrainingData | null)
   - If null/empty: show EmptyState with Dumbbell icon
   - Show frequency and focus areas at top
   - Display exercises in a list/table if present
   - Show generalNotes at bottom if present

All components: Use 'use client' directive. Handle partial data gracefully (some fields may be undefined). Use appropriate icons from lucide-react.
  </action>
  <verify>npx tsc --noEmit passes, no import errors</verify>
  <done>All 3 lifestyle display components created and type-safe</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npx tsc --noEmit` succeeds without errors
- [ ] All 8 files created (1 types file + 7 components)
- [ ] Components import types correctly
- [ ] No unused imports or variables
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- Components ready for integration in 08-02
</success_criteria>

<output>
After completion, create `.planning/phases/08-treatment-plan-view/08-01-SUMMARY.md`
</output>
