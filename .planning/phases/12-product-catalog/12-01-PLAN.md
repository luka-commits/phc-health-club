---
phase: 12-product-catalog
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - src/app/(dashboard)/patient/products/page.tsx
  - src/app/(dashboard)/patient/products/[id]/page.tsx
autonomous: true
---

<objective>
Create functional product catalog with search and product detail pages.

Purpose: Enable patients to browse, search, and view detailed product information for medications, peptides, and supplements.
Output: Search-enabled product listing and dedicated product detail page.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@src/app/(dashboard)/patient/products/page.tsx
@src/types/database.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add search functionality to products page</name>
  <files>src/app/(dashboard)/patient/products/page.tsx</files>
  <action>
Add a search input above the tabs that filters products by name and description.

Implementation:
1. Convert to client component with 'use client' directive
2. Move data fetching to a separate server component wrapper OR use useEffect with supabase client
3. Add a search input using shadcn/ui Input component with Search icon
4. Filter products in real-time as user types (case-insensitive match on name + short_description)
5. Search should work across all tabs (filter first by search, then by type in each tab)
6. Add debounce (300ms) to avoid excessive filtering on every keystroke - use simple setTimeout/clearTimeout pattern
7. Show "No products match your search" empty state when search yields no results

Layout: Search input full-width above TabsList, with placeholder "Search products..."
  </action>
  <verify>
- Page loads without errors
- Typing in search filters products across all tabs
- Clearing search shows all products again
- Tab filtering still works after search
  </verify>
  <done>Products page has working search that filters by name/description across all product types</done>
</task>

<task type="auto">
  <name>Task 2: Create product detail page</name>
  <files>src/app/(dashboard)/patient/products/[id]/page.tsx</files>
  <action>
Create a dedicated product detail page showing full product information.

Implementation:
1. Create dynamic route at /patient/products/[id]
2. Server component that fetches single product by ID from Supabase
3. Handle 404 case with notFound() if product doesn't exist or is inactive
4. Display all product fields:
   - Large header with product name and type badge
   - Image placeholder (gray box with Package icon if no image_url)
   - Short description as subtitle
   - Long description in main content area
   - Dosing information in a highlighted Card
   - Cost prominently displayed
   - List of compounding pharmacies (if any)
   - "Requires prescription" note for rx type products
5. Add "Back to Catalog" link using Link component
6. Use existing PageHeader component for consistency

Layout: Single column, max-w-3xl centered
  </action>
  <verify>
- Navigate to /patient/products/[valid-id] shows product details
- Navigate to /patient/products/[invalid-id] shows 404
- All product fields render correctly
- Back link returns to /patient/products
  </verify>
  <done>Product detail page shows full product information with proper 404 handling</done>
</task>

<task type="auto">
  <name>Task 3: Link product cards to detail page</name>
  <files>src/app/(dashboard)/patient/products/page.tsx</files>
  <action>
Make product cards clickable to navigate to the detail page.

Implementation:
1. Wrap ProductCard content in a Link component pointing to /patient/products/${product.id}
2. Add hover effect to cards (shadow-md on hover, cursor-pointer)
3. Add "View Details" text or ChevronRight icon at bottom of card to indicate clickability
4. Ensure the card link covers the entire card area for better UX
  </action>
  <verify>
- Clicking a product card navigates to its detail page
- Cards have visual hover feedback
- Navigation works from all tabs
  </verify>
  <done>Product cards are clickable and navigate to detail page with proper hover states</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Search filters products correctly
- [ ] Product detail page displays all information
- [ ] Navigation between list and detail works
- [ ] 404 handling works for invalid product IDs
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- No TypeScript errors
- Search + type filtering work together
- Product detail page shows complete product info
</success_criteria>

<output>
After completion, create `.planning/phases/12-product-catalog/12-01-SUMMARY.md`
</output>
