---
phase: 08-treatment-plan-view
plan: 02
type: execute
wave: 2
depends_on: ["08-01"]
files_modified:
  - src/app/(dashboard)/patient/treatment-plan/page.tsx
autonomous: false
---

<objective>
Integrate treatment plan display components into the patient treatment plan page.

Purpose: Replace JSON.stringify with formatted display components so patients can clearly understand their treatment protocols.
Output: Fully functional treatment plan view with clean, scannable UI.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
@~/.claude/get-shit-done/references/checkpoints.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/08-treatment-plan-view/08-CONTEXT.md
@.planning/phases/08-treatment-plan-view/08-01-SUMMARY.md

@src/types/treatment-plan.ts
@src/app/(dashboard)/patient/treatment-plan/page.tsx
@src/components/treatment-plan/prescriptions-section.tsx
@src/components/treatment-plan/peptides-section.tsx
@src/components/treatment-plan/supplements-section.tsx
@src/components/treatment-plan/lifestyle-section.tsx
@src/components/treatment-plan/nutrition-section.tsx
@src/components/treatment-plan/training-section.tsx
</context>

<tasks>

<task type="auto">
  <name>Task 1: Update treatment plan page to use new display components</name>
  <files>src/app/(dashboard)/patient/treatment-plan/page.tsx</files>
  <action>
Update the treatment-plan page.tsx to use the new display components:

1. **Import all section components:**
   - PrescriptionsSection, PeptidesSection, SupplementsSection
   - LifestyleSection, NutritionSection, TrainingSection

2. **Replace each TabsContent with the appropriate component:**
   - Lifestyle tab: `<LifestyleSection data={treatmentPlan.lifestyle_behaviors} />`
   - Nutrition tab: `<NutritionSection data={treatmentPlan.nutrition} />`
   - Training tab: `<TrainingSection data={treatmentPlan.training} />`
   - Prescriptions tab: `<PrescriptionsSection data={treatmentPlan.prescriptions_data} />`
   - Peptides tab: `<PeptidesSection data={treatmentPlan.peptides_data} />`
   - Supplements tab: `<SupplementsSection data={treatmentPlan.supplements_data} />`

3. **Remove the old Card/CardHeader/CardContent wrappers** from each tab - the section components handle their own layout.

4. **Keep the existing:**
   - Page header with status badge
   - Overview card with provider info and dates
   - Provider Notes card at bottom
   - Empty state when no treatment plan exists

5. **Type safety:** Cast the JSONB data to the correct types when passing to components.
  </action>
  <verify>npm run build succeeds, page loads without errors</verify>
  <done>Treatment plan page uses all new display components, no JSON.stringify visible</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Treatment Plan View with formatted display components for all 6 tabs</what-built>
  <how-to-verify>
    1. Run: npm run dev
    2. Log in as a patient user
    3. Navigate to: http://localhost:3000/patient/treatment-plan
    4. Check each tab:
       - Lifestyle: Should show sleep/stress/habits sections (or empty state)
       - Nutrition: Should show macro targets and guidelines (or empty state)
       - Training: Should show frequency and exercises (or empty state)
       - Prescriptions: Should show medication cards with dosage/timing (or empty state)
       - Peptides: Should show peptide cards with injection info (or empty state)
       - Supplements: Should show supplement cards (or empty state)
    5. Verify: No raw JSON visible anywhere
    6. Verify: Empty states show correctly when no data exists
    7. Verify: Layout is clean and scannable
  </how-to-verify>
  <resume-signal>Type "approved" to continue, or describe issues to fix</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Page loads without runtime errors
- [ ] All 6 tabs render their section components
- [ ] Human verification passed
</verification>

<success_criteria>
- All tasks completed
- All verification checks pass
- User approved the visual layout
- No JSON.stringify visible to patients
</success_criteria>

<output>
After completion, create `.planning/phases/08-treatment-plan-view/08-02-SUMMARY.md`
</output>
